pipeline {
    agent { dockerfile true }    
    stages {
        stage('Construção'){
            steps{
                checkout scm   
                sh 'composer install'             
            }
        }
        stage('Checkar Sintaxe') {
            steps {                
                sh './vendor/bin/phpstan analyse --memory-limit=2G'          
            }
        }
        stage('Testes Unitários') {
            steps {                
                sh 'php artisan test --coverage'          
            }
        }
    }
}